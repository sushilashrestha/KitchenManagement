let recipeList = [];
let recommendedRecipes = [];

function addRecipe() {
  const name = document.getElementById('recipeName').value;
  const image = document.getElementById('recipeImage').files[0];
  const ingredients = document.getElementById('ingredients').value;
  const instructions = document.getElementById('instructions').value;

  if (name && ingredients && instructions) {
    const recipe = {
      id: Date.now(),
      name,
      image: image ? URL.createObjectURL(image) : 'https://via.placeholder.com/300x200/FFFFFF/FFFFFF?text=No+Image',
      ingredients,
      instructions,
    };
    recipeList.push(recipe);
    renderRecipes();
    document.getElementById('addRecipeForm').reset();
  }
}

function renderRecipes() {
  const recipeListContainer = document.getElementById('recipeList');
  const recommendedRecipesContainer = document.getElementById('recommendedRecipes');

  recipeListContainer.innerHTML = '';
  recommendedRecipesContainer.innerHTML = '';

  // Render all recipes
  recipeList.forEach(recipe => {
    const recipeBox = document.createElement('div');
    recipeBox.className = 'recipe-box';
    recipeBox.innerHTML = `
      <img src="${recipe.image}" alt="${recipe.name}">
      <h3>${recipe.name}</h3>
      <button onclick="toggleRecipeDetails(${recipe.id})">View Details</button>
      <button onclick="removeRecipe(${recipe.id})">Remove</button>
      <div id="details-${recipe.id}" class="recipe-details">
        <h4>Ingredients:</h4>
        <p>${recipe.ingredients}</p>
        <h4>Instructions:</h4>
        <p>${recipe.instructions}</p>
      </div>
    `;
    recipeListContainer.appendChild(recipeBox);
  });

  // Render 4 random recommended recipes
  let randomRecipes = [...recipeList];
  shuffleArray(randomRecipes);
  randomRecipes = randomRecipes.slice(0, 4);

  randomRecipes.forEach(recipe => {
    const recommendedBox = document.createElement('div');
    recommendedBox.className = 'recipe-box';
    recommendedBox.innerHTML = `
      <img src="${recipe.image}" alt="${recipe.name}">
      <h3>${recipe.name}</h3>
    `;
    recommendedRecipesContainer.appendChild(recommendedBox);
  });
}

function toggleRecipeDetails(id) {
  const details = document.getElementById(`details-${id}`);
  details.style.display = details.style.display === 'block' ? 'none' : 'block';
}

function removeRecipe(id) {
  recipeList = recipeList.filter(recipe => recipe.id !== id);
  renderRecipes();
}

function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}
